<!DOCTYPE html>

<html lang="en">

<head>
   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width initial-scale=1"/>
   <title>Rainwater trapped in a linear array</title>
   <link rel="shortcut icon" href="/asset/favicon.ico"/>
   <link rel="stylesheet" href="/asset/style.css"/>

   <!-- Google fonts -->
   <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Alegreya:400,400i,500,500i,700,900"/>
   <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400i,700"/>
   <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Alegreya+Sans:400,700"/>
   <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Noto+Sans:400,700"/>
   <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Source+Code+Pro:600"/>
   <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Noto+Serif+KR:400,700"/>
   <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:400,700"/>

   <!-- Mathjax configuration -->
   <script src="/asset/mathjax.js" defer>
   </script>
   <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" defer>
   </script>

   <!-- random quotes -->
   <script src="/asset/quote.js" defer>
   </script>
</head>



<body>

<header id="header-banner">
   <h1 id="name-site">
      <a class="title-site" href="/">Photoluminescence</a>
      <span class="tagline-site">Math, Machines, and Music</span>
   </h1>
   <nav id="menu">
      <a class="button-menu" href="/stamp.html">by date</a>
      <span class="dingbat-menu">❦</span>
      <a class="button-menu" href="/genre.html">by genre</a>
      <span class="dingbat-menu">❦</span>
      <a class="button-menu" href="/series.html">by series</a>
      <span class="dingbat-menu">❦</span>
      <a class="button-menu" href="/tag.html">by tag</a>
   </nav>
   <img id="banner" src="/asset/banner.png" alt="banner">
</header>

<div class="essay">

<header id="header-post">
   <h2 class="heading-post">
      <span class="heading">Rainwater trapped in a linear array</span>
   </h2>
   <p class="data-post">
      <a class="data-stamp" href="/page/august-2021.html">14 August 2021</a>
      <a class="data-genre" href="/page/expositions.html">Exotic expositions</a>
      
      <a class="data-tag" href="/page/leetcode.html">LeetCode</a>
<a class="data-tag" href="/page/recursion.html">Recursion</a>
   </p>
</header>

<main class="document">
<div class="section">
<p class="paragraph">
<span class="phrase"><span class="serif-roman">You are given a set</span> <span class="math"><span class="math-letter">\(\mathbf{r}\)</span></span> <span class="serif-roman">representing the elevation map of a linear array, consisting of bars with unit width, with size</span> <span class="math"><span class="math-plain">\(N\)</span></span><span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">Compute how much water it can trap after raining.</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">Constraints:</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-plain">\(1\)</span><span class="math-sign">\(\;\leq\;\)</span><span class="math-plain">\(N\)</span><span class="math-sign">\(\;\leq\;\)</span><span class="math-plain">\(3\)</span><span class="math-plain">\(\,\cdot\,\)</span><span class="math-plain">\(1\)</span><span class="math-plain">\(0\)</span><span class="math-triplet">\(\vphantom{1 0}^{4}\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-plain">\(0\)</span><span class="math-sign">\(\;\leq\;\)</span><span class="math-letter">\(\mathbf{r}\)</span><span class="math-triplet">\(\vphantom{\mathbf{r}}_{\left[n\right]}\)</span><span class="math-sign">\(\;\leq\;\)</span><span class="math-plain">\(1\)</span><span class="math-plain">\(0\)</span><span class="math-triplet">\(\vphantom{1 0}^{5}\)</span><span class="math-mono">\(\;\mathtt{for}\;\)</span><span class="math-plain">\(n\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-plain">\(1\)</span><span class="math-plain">\(,\,\)</span><span class="math-sign">\(\,\dotsc\,\)</span><span class="math-plain">\(,\,\)</span><span class="math-plain">\(N\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
</div>
<div class="section">
<p class="paragraph">
<span class="phrase"><span class="serif-roman">For brevity, for two lists</span> <span class="math"><span class="math-letter">\(\mathbf{u}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span></span> <span class="serif-roman">we say</span> <span class="math"><span class="math-letter">\(\mathbf{u}\)</span><span class="math-sign">\(\;&lt;\;\)</span><span class="math-letter">\(\mathbf{v}\)</span></span> <span class="serif-roman">if</span> <span class="math"><span class="math-letter">\(\mathbf{u}\)</span><span class="math-triplet">\(\vphantom{\mathbf{u}}_{\left[m\right]}\)</span><span class="math-sign">\(\;&lt;\;\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-triplet">\(\vphantom{\mathbf{v}}_{\left[n\right]}\)</span></span> <span class="serif-roman">for each</span> <span class="math"><span class="math-plain">\(n\)</span></span><span class="serif-roman">;</span> <span class="serif-roman">and we similarly compare a scalar</span> <span class="math"><span class="math-letter">\(\alpha\)</span></span> <span class="serif-roman">with a list</span> <span class="math"><span class="math-letter">\(\mathbf{v}\)</span></span><span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">Also</span> <span class="math"><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{u} ,\, \mathbf{v}}\right.\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{u} ,\, \mathbf{v}}\right\rangle\)</span></span> <span class="serif-roman">is a concatenated list, with</span> <span class="math"><span class="math-letter">\(\mathbf{u}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span></span> <span class="serif-roman">understood to be flattened;</span> <span class="serif-roman">and we similarly concatenate a scalar</span> <span class="math"><span class="math-letter">\(\alpha\)</span></span> <span class="serif-roman">to a list</span> <span class="math"><span class="math-letter">\(\mathbf{v}\)</span></span><span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">We say a list to be increasing, if its components are increasing with respect to the numbered order;</span> <span class="serif-roman">and we similarly say a list to be decreasing.</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">Suppose</span> <span class="math"><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\mathbf{v}}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-bracket-square">\(\left.\vphantom{\mathbf{v}}\right]\)</span></span> <span class="serif-roman">gives the amount of rainwater trapped.</span></span> <span class="phrase"><span class="serif-roman">Let</span> <span class="math"><span class="math-plain">\(M\)</span></span> <span class="serif-roman">be the water level;</span> <span class="serif-roman">then</span> <span class="math"><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\mathbf{v}}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-bracket-square">\(\left.\vphantom{\mathbf{v}}\right]\)</span></span> <span class="serif-roman">may be found as</span> <span class="math"><span class="math-letter">\(\varphi\)</span><span class="math-bracket-square">\(\left[\vphantom{M ,\, \mathbf{v}}\right.\)</span><span class="math-plain">\(M\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-bracket-square">\(\left.\vphantom{M ,\, \mathbf{v}}\right]\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">by summing the water from the bar to the level in each grid.</span></span> <span class="phrase"><span class="serif-roman">But how to find</span> <span class="math"><span class="math-plain">\(M\)</span></span><span class="serif-roman">?</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">If</span> <span class="math"><span class="math-letter">\(\mathbf{x}\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right\rangle\)</span></span> <span class="serif-roman">with</span> <span class="math"><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha}\right\rangle\)</span></span> <span class="serif-roman">increasing, then we may remove u without affecting the result;</span> <span class="serif-roman">similar is the decreasing case:</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-mono">\(\;\mathtt{Left\_high}\;\)</span><span class="math-plain">\(:\,\)</span><span class="math-mono">\(\;\mathtt{if}\;\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha}\right\rangle\)</span><span class="math-mono">\(\;\mathtt{increasing}\;\)</span><span class="math-plain">\(,\,\)</span><span class="math-mono">\(\;\mathtt{then}\;\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\mathbf{v} ,\, \alpha ,\, \mathbf{u}\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\mathbf{v} ,\, \alpha ,\, \mathbf{u}\right\rangle}\right]\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\alpha ,\, \mathbf{u}\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{u}}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\alpha ,\, \mathbf{u}\right\rangle}\right]\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-mono">\(\;\mathtt{Right\_high}\;\)</span><span class="math-plain">\(:\,\)</span><span class="math-mono">\(\;\mathtt{if}\;\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{u}}\right\rangle\)</span><span class="math-mono">\(\;\mathtt{decreasing}\;\)</span><span class="math-plain">\(,\,\)</span><span class="math-mono">\(\;\mathtt{then}\;\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\mathbf{v} ,\, \alpha ,\, \mathbf{u}\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\mathbf{v} ,\, \alpha ,\, \mathbf{u}\right\rangle}\right]\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\mathbf{v} ,\, \alpha\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\mathbf{v} ,\, \alpha\right\rangle}\right]\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">Or if</span> <span class="math"><span class="math-letter">\(\mathbf{x}\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right\rangle\)</span></span> <span class="serif-roman">with</span> <span class="math"><span class="math-letter">\(\alpha\)</span><span class="math-sign">\(\;&gt;\;\)</span><span class="math-letter">\(\mathbf{v}\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">then we may break</span> <span class="math"><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha}\right\rangle\)</span></span> <span class="serif-roman">from</span> <span class="math"><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{u}}\right\rangle\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">and add the respective answers;</span> <span class="serif-roman">similar is the decreasing case:</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-mono">\(\;\mathtt{Left\_low}\;\)</span><span class="math-plain">\(:\,\)</span><span class="math-mono">\(\;\mathtt{if}\;\)</span><span class="math-letter">\(\alpha\)</span><span class="math-sign">\(\;&gt;\;\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-mono">\(\;\mathtt{then}\;\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\alpha ,\, \mathbf{v} ,\, \alpha ,\, \mathbf{u}\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha ,\, \mathbf{u}}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\alpha ,\, \mathbf{v} ,\, \alpha ,\, \mathbf{u}\right\rangle}\right]\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\alpha ,\, \mathbf{v} ,\, \alpha\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\alpha ,\, \mathbf{v} ,\, \alpha\right\rangle}\right]\)</span><span class="math-plain">\(\,+\,\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\alpha ,\, \mathbf{u}\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{u}}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\alpha ,\, \mathbf{u}\right\rangle}\right]\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-letter">\(\varphi\)</span><span class="math-bracket-square">\(\left[\vphantom{\alpha ,\, \left\langle\alpha ,\, \mathbf{v} ,\, \alpha\right\rangle}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{v} ,\, \alpha}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\alpha ,\, \left\langle\alpha ,\, \mathbf{v} ,\, \alpha\right\rangle}\right]\)</span><span class="math-plain">\(\,+\,\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\alpha ,\, \mathbf{u}\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{u}}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{u}}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\alpha ,\, \mathbf{u}\right\rangle}\right]\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="math"><span class="math-mono">\(\;\mathtt{Right\_low}\;\)</span><span class="math-plain">\(:\,\)</span><span class="math-mono">\(\;\mathtt{if}\;\)</span><span class="math-letter">\(\alpha\)</span><span class="math-sign">\(\;&gt;\;\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-plain">\(,\,\)</span><span class="math-mono">\(\;\mathtt{then}\;\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\mathbf{v} ,\, \alpha ,\, \mathbf{u} ,\, \alpha\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha ,\, \mathbf{u} ,\, \alpha}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha ,\, \mathbf{u} ,\, \alpha}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\mathbf{v} ,\, \alpha ,\, \mathbf{u} ,\, \alpha\right\rangle}\right]\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\alpha ,\, \mathbf{u} ,\, \alpha\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{u} ,\, \alpha}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{u} ,\, \alpha}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\alpha ,\, \mathbf{u} ,\, \alpha\right\rangle}\right]\)</span><span class="math-plain">\(\,+\,\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\mathbf{v} ,\, \alpha\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\mathbf{v} ,\, \alpha\right\rangle}\right]\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-letter">\(\varphi\)</span><span class="math-bracket-square">\(\left[\vphantom{\alpha ,\, \left\langle\alpha ,\, \mathbf{u} ,\, \alpha\right\rangle}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{u} ,\, \alpha}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{u}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{u} ,\, \alpha}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\alpha ,\, \left\langle\alpha ,\, \mathbf{u} ,\, \alpha\right\rangle}\right]\)</span><span class="math-plain">\(\,+\,\)</span><span class="math-letter">\(\psi\)</span><span class="math-bracket-square">\(\left[\vphantom{\left\langle\mathbf{v} ,\, \alpha\right\rangle}\right.\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha}\right\rangle\)</span><span class="math-bracket-square">\(\left.\vphantom{\left\langle\mathbf{v} ,\, \alpha\right\rangle}\right]\)</span><span class="math-plain">\(;\,\)</span></span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">We begin by examining</span> <span class="math"><span class="math-letter">\(\mathbf{x}\)</span></span> <span class="serif-roman">from the left end.</span></span> <span class="phrase"><span class="serif-roman">Cases</span> <code class="mono">LeftHigh</code> <span class="serif-roman">and</span> <code class="mono">LeftLow</code> <span class="serif-roman">are mutually exclusive,</span> <span class="serif-roman">and the situation that neighboring components are equal doesn’t matter.</span></span> <span class="phrase"><span class="serif-roman">But there is a remaining case, that</span> <span class="math"><span class="math-letter">\(\mathbf{x}\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{v}}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{v}}\right\rangle\)</span></span> <span class="serif-roman">with</span> <span class="math"><span class="math-letter">\(\alpha\)</span><span class="math-sign">\(\;&gt;\;\)</span><span class="math-letter">\(\mathbf{v}\)</span></span> <span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">When this happens, we turn to the right end to examine cases</span> <code class="mono">RightHigh</code> <span class="serif-roman">and</span> <code class="mono">RightLow</code> <span class="serif-roman">which is analogous.</span></span>
</p>
</div>
<div class="section">
<p class="paragraph">
<span class="phrase"><span class="serif-roman">A moment of thought reveals that the overall time complexity is</span> <span class="math"><span class="math-letter">\(\mathscr{O}\)</span><span class="math-bracket-square">\(\left[\vphantom{N}\right.\)</span><span class="math-plain">\(N\)</span><span class="math-bracket-square">\(\left.\vphantom{N}\right]\)</span></span> <span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">Suppose we are examining</span> <span class="math"><span class="math-letter">\(\mathbf{x}\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\mathbf{v} ,\, \alpha}\right.\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\alpha\)</span><span class="math-bracket-angle">\(\left.\vphantom{\mathbf{v} ,\, \alpha}\right\rangle\)</span></span> <span class="serif-roman">from the left end;</span> <span class="serif-roman">when</span> <span class="math"><span class="math-letter">\(\mathbf{v}\)</span></span> <span class="serif-roman">is removed in case</span> <code class="mono">LeftHigh</code><span class="serif-roman">,</span> <span class="serif-roman">it takes</span> <span class="math"><span class="math-letter">\(\mathscr{O}\)</span><span class="math-bracket-square">\(\left[\vphantom{\,\mathrm{size}\, \mathbf{v}}\right.\)</span><span class="math-serif">\(\,\mathrm{size}\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-bracket-square">\(\left.\vphantom{\,\mathrm{size}\, \mathbf{v}}\right]\)</span></span><span class="serif-roman">.</span></span> <span class="phrase"><span class="serif-roman">Or else when</span> <span class="math"><span class="math-letter">\(\mathbf{x}\)</span><span class="math-plain">\(\;=\;\)</span><span class="math-bracket-angle">\(\left\langle\vphantom{\alpha ,\, \mathbf{v}}\right.\)</span><span class="math-letter">\(\alpha\)</span><span class="math-plain">\(,\,\)</span><span class="math-letter">\(\mathbf{v}\)</span><span class="math-bracket-angle">\(\left.\vphantom{\alpha ,\, \mathbf{v}}\right\rangle\)</span></span> <span class="serif-roman">with</span> <span class="math"><span class="math-letter">\(\alpha\)</span><span class="math-sign">\(\;&gt;\;\)</span><span class="math-letter">\(\mathbf{v}\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">it takes</span> <span class="math"><span class="math-letter">\(\mathscr{O}\)</span><span class="math-bracket-square">\(\left[\vphantom{\,\mathrm{size}\, \mathbf{x}}\right.\)</span><span class="math-serif">\(\,\mathrm{size}\,\)</span><span class="math-letter">\(\mathbf{x}\)</span><span class="math-bracket-square">\(\left.\vphantom{\,\mathrm{size}\, \mathbf{x}}\right]\)</span></span><span class="serif-roman">,</span> <span class="serif-roman">but</span> <code class="mono">RightHigh</code> <span class="serif-roman">or</span> <code class="mono">RightLow</code> <span class="serif-roman">must happen;</span> <span class="serif-roman">component</span> <span class="math"><span class="math-letter">\(\alpha\)</span></span> <span class="serif-roman">won’t be examined again.</span></span> <span class="phrase"><span class="serif-roman">Hence any component has to be examined twice at most.</span></span>
</p>
<p class="paragraph">
<span class="phrase"><span class="serif-roman">The validity of algorithm appears obvious;</span> <span class="serif-roman">it would be able to write a proof by a generalized induction on the length of the list, according to the steps</span> <code class="mono">LeftHigh</code><span class="serif-roman">,</span> <code class="mono">LeftLow</code><span class="serif-roman">,</span> <code class="mono">RightHigh</code><span class="serif-roman">,</span> <span class="serif-roman">and</span> <code class="mono">RightLow</code> <span class="serif-roman">displayed above.</span></span>
</p>
</div>
<div class="stanza">
<p class="line">
<span class="verse"><code class="mono"># 42. Trapping Rain Water [hard]</code></span>
</p>
<p class="line">
<span class="verse"><code class="mono">#! /usr/bin/env python3</code></span>
</p>
<p class="line">
<span class="verse"><code class="mono">import typing as TYPE</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse"><code class="mono">def main():</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">rain = [0, 1, 0, 2, 1, 0, 1, 3, 2, 1, 2, 1]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">solution = Solution()</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">number = solution.count_trap(rain)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">print(&quot;There are&quot;, number, &quot;drops.&quot;)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono"># 6</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse"><code class="mono">class Solution:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def count_trap(self, rain: TYPE.List[int]) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return self.count_left(rain, 0, len(rain) - 1)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def count_left(self, rain: TYPE.List[int], start: int, stop: int) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if (stop - start &lt;= 1): return 0</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">left = self.probe_left(rain, start)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if (left &gt;= len(rain)): return self.count_right(rain, start, stop)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">water_left = sum([max(0, rain[start] - value) for value in rain[start:left+1]])</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">water_right = self.count_left(rain, left, stop)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return water_left + water_right</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def count_right(self, rain: TYPE.List[int], start: int, stop: int) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if (stop - start &lt;= 1): return 0</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">right = self.probe_right(rain, stop)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if (right &lt; 0): return self.count_left(rain, start, stop)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">water_right = sum([max(0, rain[stop] - value) for value in rain[right:stop+1]])</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">water_left = self.count_right(rain, start, right)</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return water_left + water_right</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def probe_right(self, rain: TYPE.List[int], start: int) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">limit = rain[start]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">head = start - 1</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">while (head &gt;= 0):</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if (rain[head] &gt;= limit): break</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">head -= 1</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return head</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse"><code class="mono">def probe_left(self, rain: TYPE.List[int], start: int) -&gt; int:</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">limit = rain[start]</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">head = start + 1</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">while head &lt; len(rain):</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">if (rain[head] &gt;= limit): break</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">head += 1</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span> <span class="verse">&ensp;</span> <span class="verse"><code class="mono">return head</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse"><code class="mono"># # # # # # # # # # # # # # # #</code></span>
</p>
<p class="line">
<span class="verse">&ensp;</span>
</p>
<p class="line">
<span class="verse"><code class="mono">main()</code></span>
</p>
</div>
<div class="break">
<span class="phrase">&emsp;</span> <span class="phrase">❦</span> <span class="phrase">&emsp;</span> <span class="phrase">❦</span> <span class="phrase">&emsp;</span> <span class="phrase">❦</span>
</div>
<div class="section">
<p class="paragraph">
<span class="phrase"><span class="serif-roman">❧</span> <em class="serif-italic">August 14, 2021</em></span>
</p>
</div>
</main>

</div>

<footer id="footer-whole">
   <div id="footer-quote"></div>

   <div id="footer-signature">
      <div id="footer-left">
         <p class="footer-author">violapterin</p>
         <p class="footer-motto">VOLO NON FUGIA</p>
         <p class="footer-icon">
            <a class="icon-gmail" href="mailto:violapterin@gmail.com"></a>
            <a class="icon-github" href="http://github.com/violapterin/"></a>
            <a class="icon-facebook" href="http://facebook.com/violapterin/"></a>
            <a class="icon-twitter" href="http://twitter.com/violapterin/"></a>
         </p>
         <p class="footer-license">
         <a class="icon-license" href="https://creativecommons.org/licenses/by-sa/4.0/"></a>
         </p>
      </div>
      <div id="footer-right">
         <img class="footer-profile" src="/asset/profile.png" alt="profile">
      </div>
   </div>
</footer>


</body>

</html>